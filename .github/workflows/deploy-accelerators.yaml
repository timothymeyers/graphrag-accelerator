name: Deploy Accelerator

on:
  push:
  workflow_dispatch:

jobs:

  deploy:
    environment: Commercial
    runs-on: ubuntu-latest
    #strategy:
    #  matrix:
    #    environment: [Commercial, Government]

    steps:
      - name: Check out the repository
        uses: actions/checkout@v2

      - name: Replace environment variable tokens
        run: |
          #sed -i 's/__GRAPHRAG_API_BASE__/'"${{ secrets.GRAPHRAG_API_BASE }}"'/g' infra/deploy.parameters.json

          #cat infra/deploy.parameters.json
          cd infra
          echo {"GRAPHRAG_API_BASE"="${{ secrets.GRAPHRAG_API_BASE }}" > deploy.parameters.test
          cat deploy.parameters.test
